---
title: äº†è§£ä¸€ä¸‹Array.flatMap()
tags:
  - JS
  - å­¦ä¹ 
cover: 'https://pic.imgdb.cn/item/65cdd6cf9f345e8d032f5627.jpg'
keywords: å­¦ä¹  å‰ç«¯ JS
categories: å‰ç«¯
abbrlink: 10843
date: 2024-02-29 15:38:13
---

# äº†è§£ä¸€ä¸‹ Array.flatMap()

> MDN åœ°å€ï¼š[Array.prototype.flatMap()](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap)

è¿™ä¸ª API æˆ‘ä¹‹å‰éƒ½æ²¡å¬è¿‡ï¼Œæ‰€ä»¥çœ‹åˆ°ä»–è¿˜æŒºå¥½å¥‡çš„ï¼Œç®€å•äº†è§£ä¸€ä¸‹ï¼Œç„¶åçœ‹çœ‹ä»–èƒ½åšå•¥å•¥ ğŸ¤“ã€‚

## ä»‹ç»

MDN æ˜¯è¿™ä¹ˆä»‹ç»çš„ï¼š

> flatMap() æ–¹æ³•å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ç»™å®šçš„å›è°ƒå‡½æ•°ï¼Œç„¶åå°†ç»“æœå±•å¼€ä¸€çº§ï¼Œè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚å®ƒç­‰ä»·äºåœ¨è°ƒç”¨ map() æ–¹æ³•åå†è°ƒç”¨æ·±åº¦ä¸º 1 çš„ flat() æ–¹æ³•ï¼ˆarr.map(...args).flat()ï¼‰ï¼Œä½†æ¯”åˆ†åˆ«è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ç¨å¾®æ›´é«˜æ•ˆä¸€äº›ã€‚

ğŸ˜¯ æˆ‘å†çœ‹ä¸€ä¸‹ä¾‹å­ï¼Œæ„Ÿè§‰ç†è§£çš„å·®ä¸å¤šäº†ã€‚

```js
const arr1 = [1, 2, 1]

const result = arr1.flatMap(num => (num === 2 ? [2, 2] : 1))

console.log(result) // [ 1, 2, 2, 1 ]
```

ä»–å°±æ˜¯å…ˆ map() ç„¶å flat()ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°æ”¹å˜é•¿åº¦çš„ mapğŸ¤ªã€‚

## åŸºæœ¬è¯­æ³•

```js
flatMap(cb)
flatMap(cb, thisArg)
```

ç¬¬ä¸€ä¸ªå°±æ˜¯å›è°ƒå‡½æ•°ï¼Œå‚æ•°å’Œ map ä¸€æ ·ï¼Œä¸å¤šä»‹ç»äº†ã€‚ç¬¬äºŒä¸ªæ˜¯å›è°ƒå‡½æ•°çš„ this å€¼ï¼Œå¯é€‰ï¼Œä¹Ÿä¸ç”¨ä»‹ç»äº†ã€‚

### å¯¹æ¯” map

ä»–å°±æ˜¯ç›¸å½“äº map åå† flat(1)ï¼Œæ‰å¹³ä¸€å±‚

```js
const arr = [1, 2, 3]

arr.map(x => [x * 2])
// [[2], [4], [6]]

arr.flatMap(x => [x * 2])
// [2, 4, 6]

// åªæ‰å¹³ä¸€å±‚
arr.flatMap(x => [[x * 2]])
// [[2], [4], [6]]
```

è¿™ä¸ªç‰¹æ€§ä¹Ÿå°±è®©ä¸‹é¢è¿™ä¸ªæƒ…å†µæ›´ç®€æ´ï¼š

```js
const arr1 = ["it's Sunny in", '', 'California']

arr1.map(x => x.split(' '))
// [["it's","Sunny","in"],[""],["California"]]

arr1.flatMap(x => x.split(' '))
// ["it's","Sunny","in", "", "California"]
```

æ‰€ä»¥è¯´ï¼ŒflatMap å¯ä»¥å®ç°ä¸€ä¸ªä¸€å¯¹å¤šçš„æ˜ å°„ï¼Œæ¯”å¦‚ï¼š

```js
// å‡è®¾æˆ‘ä»¬æƒ³è¦åˆ é™¤æ‰€æœ‰è´Ÿæ•°ï¼Œå¹¶å°†å¥‡æ•°æ‹†åˆ†æˆå¶æ•°å’Œ 1
const a = [5, 4, -3, 20, 17, -33, -4, 18]
//         |\  \  x   |  | \   x   x   |
//        [4,1, 4,   20, 16, 1,       18]

const result = a.flatMap(n => {
  if (n < 0) return []
  return n % 2 === 0 ? [n] : [n - 1, 1]
})
console.log(result) // [4, 1, 4, 20, 16, 1, 18]
```

## ç”¨æ³•

æ¯”å¦‚è¿™æ ·çš„æƒ…å†µï¼š[0, 3, 6] -> [6, 12]ï¼Œéœ€è¦å»é™¤ 0ï¼Œç„¶åä¹˜ä»¥ 2

map éœ€è¦è¿™æ ·ï¼š

```js
const arr = [0, 3, 6]

const arr1 = arr.filter(n => n !== 0).map(n => n * 2)
```

è€Œ flatMap å¯ä»¥ç®€å•ä¸€äº›ï¼š

```js
const arr = [0, 3, 6]

const arr2 = arr.flatMap(x => (x === 0 ? [] : [x * 2]))
```

## å‚è€ƒæ–‡ç« 

[array.flatMapï¼šä¸€ä¸ªçµæ´»å¥½ç”¨çš„ Map æ–¹æ³•
](https://juejin.cn/post/7055950245724684318)
